pipeline {
    agent { 
        label 'docker'
    }
    
    environment {
        registry = "kammana/my-app:2.0.0"
    }
    
    stages {
        
        stage ('Build Docker Image') {
            agent {
                docker {
                  label 'docker'  // both label and image
                  image 'maven:3-alpine'
                }
            }
 
            steps {
                script {
                    docker.build registry + ":$BUILD_NUMBER"
                }
            }
        }
    }
} 
